# About Sniffing
**'코를 킁킁거리다'** 라는 뜻의 대표적인 공격으로 도청이 있다. **수동적(passive) 공격**이라고도 한다.

## 공격의 원리
네트워크 카드는 패킷의 IP주소와 MAC 주소를 인식하고 자신의 버퍼에 저장할지를 결정한다.
네트워크 카드에 인식된 데이터 링크/네트워크 계층의 정보가 일치하지 않는 패킷은 무시한다.

그렇기에 공격을 하기 위해 랜 카드의 네트워크 계층의 필터링 해제 모드를 실행하는데 이것을 ```promiscuous``` 모드라고 한다.

## 공격의 종류
1. 스위치에는 포트와 MAC 주소를 저장한 테이블이 있다. 이 정상적인 스위칭 기능을 마비시키는 공격이 ```Switch jamming``` 이다.
2. 포트 미러링 기능을 이용하는 ```Switch Port Analyzer(SPAN)``` 포트 태핑 공격이 있다.

## 공격의 탐지
수동적인 공격으로 이상 현상을 일으키지 않기 때문에 능동적인 탐지를 통해서 잡아내야 한다.
스니퍼는 ```promiscuous``` 모드에서 작동한다는 것을 기억하고 탐지한다.

### ping
네트워크에 존재하지 않는 MAC 주소를 위장시켜 호스트에 ping을 보낸다. 만약 ```ICMP echo reply``` 를 받는다면 프러미스큐어스 모드가 동작 중이라는 것을 의미한다.
존재하지 않는 MAC 주소는 ```ping request```를 볼 수 없는 것이 정상이다.

### ARP
ping과 유사하게 위조된 ```ARP request``` 를 보냈을 때, ```ARP response``` 를 받는다면 프러미스큐어스 모드가 동작 중이다.

### DNS
일반적인 스니핑 프로그램은 Reverse-DNS lookup을 수행한다. 
테스트 대상 네트워크로 ```ping sweep``` 을 보내고 들어오는 Reverse-DNS lookup을 감시하여 탐지한다.

### ARP watch
MAC 주소와 IP 주소의 매칭 값을 초기에 저장하고 ARP 트래픽을 모니터링하여 이를 변하게 하는 패킷이 탐지되면 관리자에게 메일로 알려주는 tool이다.

### 유인
스니핑 공격의 주요 목적은 아이디와 패스워드이다.
이 점을 이용하여 가짜 아이디와 패스워드를 네트워크에 뿌리고, 이 아이디와 패스워드가 사용될 때, 탐지할 수 있다.

